<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karolina Protsenko - Violinist</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        body {
            background-color: rgb(143, 18, 184);
            margin: 0;
            font-family: Arial, sans-serif;
            color: white;
        }
        canvas {
            display: block;
            width: 100%;
            height: auto;
        }
        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: rgba(255, 0, 200, 0.45);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        #logo {
            display: flex;
            align-items: center;
        }
        #logo img {
            margin-left: 10px;
        }
        #logo h1 {
            margin: 0;
            color: white;
        }
        #subheader {
            width: 100%;
            text-align: center;
            padding: 10px 0;
            background-color: rgba(255, 0, 200, 0.45);
            font-size: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            margin-top: 80px;
        }
        #game {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            max-width: 800px;
            margin: 20px auto;
            text-align: center;
        }
        #gameBoard {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        .card {
            width: 100px;
            height: 100px;
            background-color: white;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            cursor: pointer;
        }
        .matched {
            background-color: lightgreen;
            pointer-events: none;
        }
        @media (max-width: 600px) {
            #header {
                flex-direction: column;
            }
            #game {
                margin: 100px 10px 20px;
            }
            #gameBoard {
                grid-template-columns: repeat(2, 100px);
            }
            canvas {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <div id="logo">
            <h1>Karolina Protsenko</h1>
            <img src="violin_img.png" alt="Violin Logo" width="50" height="50">
        </div>
    </div>
    <div id="subheader">A Small Game for Karolina</div>
    <canvas id="violinCanvas"></canvas>
    <div id="game">
        <h2>Memory Card Matching Game</h2>
        <div id="gameBoard"></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script>
        let scene, camera, renderer, violin, bow, violinLoaded = false;

        function init() {
            scene = new THREE.Scene();
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 10);
            camera.fov = 45;
            camera.updateProjectionMatrix();

            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('violinCanvas'), alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            const ambientLight = new THREE.AmbientLight(0x404040, 2);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 2);
            directionalLight.position.set(5, 10, 7.5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            directionalLight.shadow.mapSize.width = 1024;
            directionalLight.shadow.mapSize.height = 1024;
            directionalLight.shadow.camera.near = 0.5;
            directionalLight.shadow.camera.far = 500;

            const planeGeometry = new THREE.PlaneGeometry(500, 500);
            const planeMaterial = new THREE.ShadowMaterial({ opacity: 0.5 });
            const plane = new THREE.Mesh(planeGeometry, planeMaterial);
            plane.rotation.x = - Math.PI / 2;
            plane.position.y = -5;
            plane.receiveShadow = true;
            scene.add(plane);

            const loader = new THREE.GLTFLoader();
            loader.load('./models/polish_violin.glb', (gltf) => {
                violin = gltf.scene;
                violin.scale.set(0.015, 0.015, 0.015);
                violin.position.set(0, 0, -1);
                violin.rotation.set(0, -7.9, 0);

                violin.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                        if (node.material) {
                            node.material.emissive = new THREE.Color(0x111111);
                            node.material.emissiveIntensity = 2;
                        }
                    }
                });

                scene.add(violin);
                violinLoaded = true;
                animateBow();
                showLogo();
            });

            loader.load('./models/violin_bow.glb', (gltf) => {
                bow = gltf.scene;
                bow.scale.set(0.1, 0.1, 0.1);
                bow.position.set(0, 0, 0);
                bow.rotation.set(0, Math.PI / 2, 0);

                bow.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                        if (node.material) {
                            node.material.emissive = new THREE.Color(0x111111);
                            node.material.emissiveIntensity = 0.1;
                        }
                    }
                });

                scene.add(bow);
            });

            window.addEventListener('resize', onWindowResize, false);
            render();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animateBow() {
            if (violinLoaded) {
                let bowPosition = 0;
                setInterval(() => {
                    bowPosition += 0.05;
                    bow.position.x = Math.sin(bowPosition) * 0.5;
                }, 1000 / 60);
            }
        }

        function render() {
            requestAnimationFrame(render);
            renderer.render(scene, camera);
        }

        function showLogo() {
            setTimeout(() => {
                document.getElementById('logo').style.opacity = '1';
            }, 2000);
        }

        init();

        const cardSymbols = ['🎻', '🎵', '🎶', '🎤', '🎧', '🎷', '🎸', '🥁'];
        let cards = [...cardSymbols, ...cardSymbols];
        let firstCard = null;
        let secondCard = null;
        let boardLocked = false;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function createBoard() {
            shuffle(cards);
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';
            cards.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.symbol = symbol;
                card.dataset.index = index;
                card.addEventListener('click', flipCard);
                gameBoard.appendChild(card);
            });
        }

        function flipCard() {
            if (boardLocked) return;
            if (this === firstCard) return;
            this.textContent = this.dataset.symbol;

            if (!firstCard) {
                firstCard = this;
                return;
            }

            secondCard = this;
            checkForMatch();
        }

        function checkForMatch() {
            if (firstCard.dataset.symbol === secondCard.dataset.symbol) {
                disableCards();
                return;
            }
            unflipCards();
        }

        function disableCards() {
            firstCard.classList.add('matched');
            secondCard.classList.add('matched');
            resetBoard();
        }

        function unflipCards() {
            boardLocked = true;
            setTimeout(() => {
                firstCard.textContent = '';
                secondCard.textContent = '';
                resetBoard();
            }, 1000);
        }

        function resetBoard() {
            [firstCard, secondCard] = [null, null];
            boardLocked = false;
        }

        createBoard();
    </script>
</body>
</html>